(function(a){var f=require("log");var i={};i.options={method:"GET",asynchronous:true,contentType:"application/x-www-form-urlencoded",encoding:"UTF-8",parameters:"",timeout:Infinity,interval:50,empty:null};var m=0;var h=1;var g=2;var o=3;var p=4;i.isSameOrigin=function(u){var t=u.toString().match(/^\s*((file|http|https):\/\/[a-z\.-]*:?\d{0,6})/);var v=document.location;var w=v.protocol+"//"+document.domain+(v.port?":"+v.port:"");return !!t&&(t[1]==w)};var r=i.isSameOrigin;i.serializeParameters=function(v){if("function"!=typeof(v.hasOwnProperty)){throw new TypeError("parameters must be a JavaScript (hash) object")}var u=[];for(var t in v){if(v.hasOwnProperty(t)){var w=v[t];if("function"==typeof(w.forEach)){w.forEach(function(x){u.push(rfc3986encode(t)+"="+rfc3986encode(x))})}else{u.push(rfc3986encode(t)+"="+rfc3986encode(w))}}}return u.join("&")};var j=i.serializeParameters;i.rfc3986encode=function(t){if(null===t){return""}return encodeURIComponent(t.toString()).replace(/%20/g,"+").replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A")};rfc3986encode=i.rfc3986encode;i.rfc3986decode=function(t){if(null===t){return""}return decodeURIComponent(t.toString().replace(/\+/g," ").replace(/%21/g,"!").replace(/%27/g,"'").replace(/%28/g,"(").replace(/%29/g,")").replace(/%2A/g,"*"))};rfc3986decode=i.rfc3986decode;i.success=function(t){return !t||(t>=200&&t<300)||t==304};var e=i.success;i.createStreamPatternFilter=function(u,v){var t="";return function(y,x){var w;t+=y;while(w=t.match(u)){var z=t.indexOf(w[0]);t=t.substring(z+w[0].length,t.length);v(w[0])}}};i.createStreamSeparatorFilter=function(u,v){var t="";return function(A,y){t+=A;var z=t.split(u),w=z.length;for(var x=0;x<w-1;x++){v(z[x])}if(y){v(z[w-1])}else{t=z[w-1]}}};function q(){return new XMLHttpRequest()}function n(w){var v={"X-Requested-With":"XMLHttpRequest",Accept:"text/plain, application/json, application/xml, text/javascript, text/xml, */*"},u={};for(var t in w._options.headers||{}){u[t]=w._options.headers[t]}for(var t in v){if(!(u.hasOwnProperty(t))){u[t]=v[t]}}if(w.overrideMimeType&&(navigator.userAgent.match(/Gecko\/(\d{4})/)||[0,2005])[1]<2005){u.Connection="close"}for(var t in u){if(u.hasOwnProperty(t)){w.setRequestHeader(t,u[t])}}}function s(v){var t=null,u=v._options;if(!u.method.match(/GET|DELETE|OPTIONS|HEAD/)){if(XML&&u.body instanceof (XML)){t=t.toXMLString();u.headers["Content-Type"]=u.headers["Content-Type"]||"application/xml; charset=utf-8"}else{if(u.body instanceof Object){t=JSON.stringify(t);u.headers["Content-Type"]=u.headers["Content-Type"]||"application/json; charset=utf-8"}else{t=u.body.toString();u.headers["Content-Type"]=u.headers["Content-Type"]||"text/plain; charset=utf-8"}}}return t}function b(w,v){var x=q();x._options=v;x._url=w;if(x._options.parameters){w+=(0>=w.indexOf("?")?"?":"&")+j(x._options.parameters)}x.onreadystatechange=function(){l(x)};x.open(v.method,w,true);n(x);var t=s(x);if(v.timeout&&v.timeout<Infinity){var u=Date.now();window.setTimeout(function(){x._options={};x.abort();if("function"==typeof(v.onTimeout)){d(v.onTimeout,[x,Date.now()-u])}},v.timeout)}x.send(t);return x}function d(u,t){try{u.apply(null,t)}catch(v){if("onException" in t[0]._options){t[0]._options.onException(v,t[0])}else{f.error("Unhandled exception on ajax readyStateChange",v,t)}}}function l(v){var u=v._options;if("function"==typeof(u.onInteractive)){if(o===v.readyState&&!v._poll){v._poll=window.setInterval(function(){d(k,[v,false])},u.interval);return}if(p==v.readyState){clearInterval(v._poll);d(k,[v,true])}}if("function"==typeof(u.onLoading)&&h===v.readyState){d(u.onLoading,[v]);return}if("function"==typeof(u.onLoaded)&&g===v.readyState){d(u.onLoaded,[v]);return}if(p===v.readyState){var t=v.status;if("function"==typeof(u["on"+t])){d(u["on"+t],[v])}if(e(t)&&"function"==typeof(u.onSuccess)){d(u.onSuccess,[v])}if(!e(t)&&"function"==typeof(u.onFailure)){d(u.onFailure,[v])}if("function"==typeof(u.onComplete)){d(u.onComplete,[v])}}}function k(x,v){var u=x.responseText,t=u.length;x._cursor=x._cursor||0;if(t>x._cursor){var w=u.substring(x._cursor,t);x._options.onInteractive(w,v);x._cursor=t}}i.Request=function c(v,u){if(!(this instanceof c)){f.warn("ajax.Request is a constructor, call with 'new' statement!");return new c(v,u)}var x,t=i.options;for(var w in t){if(!u.hasOwnProperty(w)){u[w]=t[w]}}this.getState=function(){return x.readyState};this.getXHR=function(){return x};this.getURL=function(){return v};x=b(v,u)};a.ajax=i})(require.modules);